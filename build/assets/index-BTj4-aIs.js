import{B as R,F as M,u as B,r as h,j as e,C as z,a as G,T as A,b as x,L as Y,c as w,G as p,D as P,h as b,d as N,e as U,f as q,P as _,g as K,i as Q,k as $,l as n,m as J,n as T,M as F,A as V,o as X,I as Z,p as ee,q as te,s as se,R as ae,t as I,N as ne,v as oe,w as re,Q as ie}from"./vendor-CMhLJh8W.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))g(s);new MutationObserver(s=>{for(const t of s)if(t.type==="childList")for(const u of t.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&g(u)}).observe(document,{childList:!0,subtree:!0});function d(s){const t={};return s.integrity&&(t.integrity=s.integrity),s.referrerPolicy&&(t.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?t.credentials="include":s.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function g(s){if(s.ep)return;s.ep=!0;const t=d(s);fetch(s.href,t)}})();const c=o=>{R.warn(o,{position:"top-center",autoClose:1200,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light",transition:M})},k=o=>{R.success(o,{position:"top-center",autoClose:1200,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light",transition:M})};function le(){const o=B(),[a,d]=h.useState({username:"",password:""}),[g,s]=h.useState(!1),t=i=>{const{name:m,value:f}=i.target;d(C=>({...C,[m]:f}))},u=i=>{sessionStorage.setItem("token",i)},j=async()=>{if(!a.username)c("Вы не ввели имя пользователя.");else if(!a.password)c("Вы не ввели пароль.");else{s(!0);try{const i=await w.post("https://test.v5.pryaniky.com/ru/data/v3/testmethods/docs/login",a);i.data.error_code===0?(u(i.data.data.token),o("/data"),k("Добро пожаловать!")):c("Неверное имя пользователя или пароль.")}catch{c("В процессе авторизации произошла ошибка, попробуйте снова.")}finally{s(!1)}}};return e.jsx(z,{children:e.jsxs(G,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx(A,{variant:"h4",children:"Авторизация"}),e.jsx(x,{label:"Имя пользователя",name:"username",value:a.username,onChange:t}),e.jsx(x,{label:"Пароль",name:"password",type:"password",value:a.password,onChange:t}),e.jsx(Y,{variant:"contained",size:"large",onClick:j,loading:g,children:"Авторизоваться"})]})})}function W({closeModal:o,getData:a,doc:d,isUpdate:g}){const s=sessionStorage.getItem("token"),[t,u]=h.useState(d),[j,i]=h.useState(!1),m=l=>{const{name:S,value:D}=l.target;u(v=>({...v,[S]:D}))},f=(l,S)=>{if(l){const D=l.toISOString();u(v=>({...v,[S]:D}))}},C=async()=>{if(!t.documentStatus||!t.employeeNumber||!t.documentType||!t.documentName||!t.companySignatureName||!t.employeeSignatureName||!t.employeeSigDate||!t.companySigDate)c("Заполните все обязательные поля");else try{i(!0),(await w.post("https://test.v5.pryaniky.com/ru/data/v3/testmethods/docs/userdocs/create",t,{headers:{"x-auth":`${s}`}})).data.error_code===0?(await a(),k("Документ успешно добавлен")):c("В процессе добавления произошла ошибка, попробуйте снова.")}catch{c("В процессе добавления произошла ошибка, попробуйте снова.")}finally{i(!1),o()}},y=async l=>{if(!t.documentStatus||!t.employeeNumber||!t.documentType||!t.documentName||!t.companySignatureName||!t.employeeSignatureName||!t.employeeSigDate||!t.companySigDate)c("Все поля должы быть обязательно заполнены.");else try{i(!0),await w.post(`https://test.v5.pryaniky.com/ru/data/v3/testmethods/docs/userdocs/set/${l}`,t,{headers:{"x-auth":`${s}`}}),await a(),k("Документ успешно изменен")}catch{c("В процессе изменения произошла ошибка, попробуйте снова.")}finally{i(!1),o()}};return e.jsxs(e.Fragment,{children:[e.jsxs(p,{container:!0,spacing:2,children:[e.jsx(p,{item:!0,xs:6,children:e.jsx(x,{label:"Статус документа",name:"documentStatus",value:t.documentStatus,onChange:m,fullWidth:!0})}),e.jsx(p,{item:!0,xs:6,children:e.jsx(x,{label:"Номер сотрудника",name:"employeeNumber",value:t.employeeNumber,onChange:m,fullWidth:!0})}),e.jsx(p,{item:!0,xs:6,children:e.jsx(x,{label:"Тип документа",name:"documentType",value:t.documentType,onChange:m,fullWidth:!0})}),e.jsx(p,{item:!0,xs:6,children:e.jsx(x,{label:"Наименование документа",name:"documentName",value:t.documentName,onChange:m,fullWidth:!0})}),e.jsx(p,{item:!0,xs:6,children:e.jsx(x,{label:"Компания-подписант",name:"companySignatureName",value:t.companySignatureName,onChange:m,fullWidth:!0})}),e.jsx(p,{item:!0,xs:6,children:e.jsx(x,{label:"Сотрудник-подписант",name:"employeeSignatureName",value:t.employeeSignatureName,onChange:m,fullWidth:!0})}),e.jsx(p,{item:!0,xs:6,children:e.jsx(P,{label:"Дата подписания сотрудником",format:"DD.MM.YYYY",value:b(t.employeeSigDate),onChange:l=>f(l,"employeeSigDate")})}),e.jsx(p,{item:!0,xs:6,children:e.jsx(P,{label:"Дата подписания компанией",format:"DD.MM.YYYY",value:b(t.companySigDate),onChange:l=>f(l,"companySigDate")})})]}),e.jsx(N,{sx:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"},children:g?e.jsx(Y,{variant:"contained",sx:{mt:2,height:40,width:200},onClick:()=>y(d.id),loading:j,children:"Изменить"}):e.jsx(Y,{variant:"contained",sx:{mt:2,height:40,width:200},onClick:C,loading:j,children:"Добавить"})})]})}function ce(){const[o,a]=h.useState([]),[d,g]=h.useState(!1),[s,t]=h.useState(!1),u=sessionStorage.getItem("token"),j=()=>g(!0),i=()=>g(!1),m=()=>t(!0),f=()=>t(!1),[C,y]=h.useState(!1),l={id:"",documentStatus:"",employeeNumber:"",documentType:"",documentName:"",companySignatureName:"",employeeSignatureName:"",employeeSigDate:b(),companySigDate:b()},[S,D]=h.useState(l),v={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,height:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4,display:"grid",flexDirection:"column",gap:2},O=async()=>{y(!0);try{const r=await w.get("https://test.v5.pryaniky.com/ru/data/v3/testmethods/docs/userdocs/get",{headers:{"x-auth":`${u}`}});a(r.data.data)}catch{c("При получении данных произошла ошибка, обновите страницу.")}finally{y(!1)}},E=async r=>{y(!0);try{await w.delete(`https://test.v5.pryaniky.com/ru/data/v3/testmethods/docs/userdocs/delete/${r}`,{headers:{"x-auth":`${u}`}}),a(L=>L.filter(H=>H.id!==r)),k("Документ успешно удален")}catch{c("В процессе удаление произошла ошибка, попробуйте снова.")}finally{O(),y(!1)}};return h.useEffect(()=>{O()},[]),e.jsxs(e.Fragment,{children:[C?e.jsx(N,{children:e.jsx(U,{})}):e.jsx(q,{component:_,children:e.jsxs(K,{sx:{minWidth:650},"aria-label":"simple table",children:[e.jsx(Q,{children:e.jsxs($,{children:[e.jsx(n,{children:"Статус документа"}),e.jsx(n,{align:"right",children:"Номер сотрудника"}),e.jsx(n,{align:"right",children:"Тип документа"}),e.jsx(n,{align:"right",children:"Наименование документа"}),e.jsx(n,{align:"right",children:"Компания-подписант"}),e.jsx(n,{align:"right",children:"Сотрудник-подписант"}),e.jsx(n,{align:"right",children:"Дата подписания сотрудником"}),e.jsx(n,{align:"right",children:"Дата подписания компанией"}),e.jsx(n,{align:"right",children:"Удаление документа"}),e.jsx(n,{align:"right",children:"Изменение документа"})]})}),e.jsx(J,{children:o.map((r,L)=>e.jsxs($,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(n,{component:"th",scope:"row",children:r.documentStatus}),e.jsx(n,{align:"right",children:r.employeeNumber}),e.jsx(n,{align:"right",children:r.documentType}),e.jsx(n,{align:"right",children:r.documentName}),e.jsx(n,{align:"right",children:r.companySignatureName}),e.jsx(n,{align:"right",children:r.employeeSignatureName}),e.jsx(n,{align:"right",children:b(r.employeeSigDate).format("DD.MM.YYYY")}),e.jsx(n,{align:"right",children:b(r.companySigDate).format("DD.MM.YYYY")}),e.jsx(n,{align:"right",children:e.jsx(T,{variant:"contained",color:"error",onClick:()=>E(r.id),children:"Удалить"})}),e.jsxs(n,{align:"right",children:[e.jsx(T,{variant:"contained",onClick:()=>{D(r),m()},children:"Изменить"}),e.jsx(F,{open:s,onClose:f,children:e.jsx(N,{sx:v,children:e.jsx(W,{closeModal:f,getData:O,doc:S,isUpdate:!0})})})]})]},L))})]})}),e.jsx(T,{variant:"contained",size:"large",sx:{mt:2},onClick:j,children:"Добавить документ"}),e.jsx(F,{open:d,onClose:i,children:e.jsx(N,{sx:v,children:e.jsx(W,{closeModal:i,getData:O,doc:l,isUpdate:!1})})})]})}function de(){const o=B(),a=async()=>{try{sessionStorage.removeItem("token"),o("/login"),k("Вы вышли из системы.")}catch{c("Произошла ошибка при выхрде из системы, попробуйте еще раз.")}};return e.jsx(N,{sx:{flexGrow:1,width:"100%"},children:e.jsx(V,{position:"absolute",children:e.jsxs(X,{children:[e.jsx(Z,{size:"large",edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2}}),e.jsx(A,{variant:"h6",component:"div",sx:{flexGrow:1},children:"Сервис работы с документами"}),e.jsx(T,{color:"inherit",onClick:a,children:"Выйти"})]})})})}function ue(){const o=ee(),a=B();return h.useEffect(()=>{const d=sessionStorage.getItem("token");o.pathname==="/data"&&!d&&a("/login")},[o,a]),e.jsxs(te,{dateAdapter:se,adapterLocale:"ru",children:[e.jsx(de,{}),e.jsxs(ae,{children:[e.jsx(I,{path:"/",element:e.jsx(ne,{to:"/login"})}),e.jsx(I,{index:!0,path:"/login",element:e.jsx(le,{})}),e.jsx(I,{path:"/data",element:e.jsx(ce,{})})]})]})}oe(document.getElementById("root")).render(e.jsxs(re,{children:[e.jsx(ie,{position:"top-center",autoClose:1200,hideProgressBar:!0,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!1,draggable:!0,pauseOnHover:!1,theme:"light",transition:M}),e.jsx(ue,{})]}));
